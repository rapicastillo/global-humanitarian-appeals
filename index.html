<!DOCTYPE html>
<html>
<head>
  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
  <style>
    body { background-color: black; }
    #title-slides-area { position: relative; background-color: whitesmoke; background: url(images/title-000.png); }
    #title-slides-area > .row { position: absolute; bottom: 0; }
    #title-slides-area > .row > div { height: 100%; position: relative; }
    #title-slides-area #stats-area { opacity: 0; }
    .people-fade { background-image: url(images/s1/people-row.png); background-size: cover; background-repeat: no-repeat; position: absolute; bottom: 0; width: 100%;}

    #title-slides-area #first-needs-graph {
      height: 0%; background-image: url(images/s1/arrow-up.png); background-position: center top; position: absolute; bottom: 0; width: 80%;

    }
  </style>
  <!-- SLIDE 2 STYLE -->
  <style>
	#slide-1-faced-with-unprecendented-severity { background-image: url(images/floating-01.jpg); background-size: cover; background-repeat: no-repeat; position: relative; overflow-y: hidden;}
    #slide-1-faced-with-unprecendented-severity .slide-element { position: relative; }
    #slide-1-faced-with-unprecendented-severity .image_container { position: absolute; }
    #slide-1-faced-with-unprecendented-severity .window-size { overflow-y: hidden; }

    #slide-1-faced-with-unprecendented-severity .image-big { z-index: 1000; width: 100px; height: 100px; }
    #slide-1-faced-with-unprecendented-severity .image-big img { width: 100px; height: 100px; }
    #slide-1-faced-with-unprecendented-severity .image-medium { z-index: 300; opacity: 0.9; width: 200px; height: 200px;}
    #slide-1-faced-with-unprecendented-severity .image-medium img { width: 200px; height: 200px; }
    #slide-1-faced-with-unprecendented-severity .image-small { z-index: 50; opacity: 0.5; width: 100px; height: 100px;}
    #slide-1-faced-with-unprecendented-severity .image-small img { width: 100px; height: 100px; }
    #slide-1-faced-with-unprecendented-severity .burst-message { z-index: 500; height: 200px; position: absolute;}

    .burst-message h1  { font-size: 26px; }
    .burst-message h2  { font-size: 18px; }
    .burst-message h1, .burst-message h2 {
      color: whitesmoke;
    }

    .burst-message h1 strong { font-size: 32px; }
    .burst-message h1 strong, .burst-message h2 strong{
      color: #013856;
      font-weight: 800;
    }
  </style>

  <!-- SLIDE 3 STYLE -->
  <style>
    #s3-slide-show-stats .image-slideshow { position: relative; }
    #s3-slide-show-stats .image-slideshow .first-slide { z-index: 1000; }
    #s3-slide-show-stats .image-slideshow .second-slide { z-index: 900; }
    #s3-slide-show-stats .image-slideshow .third-slide { z-index: 800; }

    #s3-slide-show-stats .image-slideshow .first-slide,
    #s3-slide-show-stats .image-slideshow .second-slide,
    #s3-slide-show-stats .image-slideshow .third-slide
    {
      position: absolute;
      background-size: cover;
    }

    #s3-slide-show-stats .image-slideshow .first-slide { background-color: blue; }
    #s3-slide-show-stats .image-slideshow .second-slide { background-color: red; }
    #s3-slide-show-stats .image-slideshow .third-slide { background-color: yellow; }

    #s3-slide-show-stats .image-slideshow .fact-item {
      position: absolute;
      font-size: 48px;
      z-index: 2000;
      opacity: 0;
    }
  </style>
  <style>
      .image-slideshow-item { position: relative; }
      .image-slideshow-item .first-slide { z-index: 1000; }
      .image-slideshow-item .second-slide { z-index: 900; }
      .image-slideshow-item .third-slide { z-index: 800; }

      .image-slideshow-item .first-slide,
      .image-slideshow-item .second-slide,
      .image-slideshow-item .third-slide
      {
        position: absolute;
        background-size: cover;
        background-position: center center;

      }

      .image-slideshow-item .fact-item
      {
        color: #f47932;
        background-color: rgba(0, 56, 86, 0.70);
        padding: 5px 20px;

        font-size: 16px;

        right: 0px;
      }

      .image-slideshow-item .fact-item * {
        display: inline-block;
        vertical-align: middle;
      }

      .image-slideshow-item .country-title-item
      {
        position: absolute;
        bottom: 30px;
        opacity: 0;

        z-index: 2000;

        color: white;

        background-color: rgba(155, 182, 44, 0.70);
        padding: 5px 20px;

        font-size: 16px;
      }

      .image-slideshow-item .country-title-item h1 { margin: 0; font-size: 28px; }

      /*.image-slideshow .first-slide { background-image: url(http://ocha.smugmug.com/Countries/Philippines/Typhoon-Haiyan-Life-inside-and/i-GPfJ3z3/0/X3/December%2011%2C%202013%20A%20child%20affected%20by%20Typhoon%20Yolanda%20walk%20amid%20the%20debris%20around%20%20two%20ships%20that%20were%20carried%20inland%20by%20the%20storm%20surge.%20%20Source%20OCHA%20Gemma%20Cortes-X3.jpg) }
      .image-slideshow .second-slide { background-image: url(http://ocha.smugmug.com/Countries/Philippines/Typhoon-Haiyan-Life-inside-and/i-T4RszF2/0/X3/IMG_2351-X3.jpg); }
      .image-slideshow .third-slide { background-image: url(http://ocha.smugmug.com/Countries/Philippines/Typhoon-Haiyan-Life-inside-and/i-jPt5THK/1/X3/IMG_2408-X3.jpg); }*/

      .image-slideshow-item .fact-item {
        position: absolute;
        font-size: 22px;
        z-index: 2000;
        opacity: 0;
      }

      #slide-1-philippines .first-slide { background-image: url(images/l3/philippines/000.jpg); }
      #slide-1-philippines .second-slide { background-image: url(images/l3/philippines/001.jpg); }
      #slide-1-philippines .third-slide { background-image: url(images/l3/philippines/002.jpg); }

      #slide-2-syria .first-slide { background-image: url(images/l3/syria/000.jpg); }
      #slide-2-syria .second-slide { background-image: url(images/l3/syria/001.jpg); }
      #slide-2-syria .third-slide { background-image: url(images/l3/syria/002.jpg); }

      #slide-3-south-sudan .first-slide { background-image: url(images/l3/southsudan/000.jpg); }
      #slide-3-south-sudan .second-slide { background-image: url(images/l3/southsudan/001.jpg); }
      #slide-3-south-sudan .third-slide { background-image: url(images/l3/southsudan/002.jpg); }

      #slide-4-car .first-slide { background-image: url(images/l3/car/000.jpg); }
      #slide-4-car .second-slide { background-image: url(images/l3/car/001.jpg); }
      #slide-4-car .third-slide { background-image: url(images/l3/car/002.jpg); }

      #slide-5-iraq .first-slide { background-image: url(images/l3/iraq/000.jpg); }
      #slide-5-iraq .second-slide { background-image: url(images/l3/iraq/001.jpg); }
      #slide-5-iraq .third-slide { background-image: url(images/l3/iraq/002.jpg); }
    </style>
</head>
<body>
  <div id="title-slides-area" class="fluid-container">
    <div class="row" style=" width: 100% ">
      <div class="col-md-7" id="first-with-people-fades">
        <div class="row">
          <div class="col-md-12 text-right">
            <h1>Staggering</h1>
            <h1>Demands</h1>
            <h3>Humanitarian Global Appeals lorem ipsum dolor sikmet</h3>
          </div>
        </div>
      </div>
      <div class="col-md-1" >
        <div id="first-needs-graph" style="">
          <h4>$<span  data-final-count="7.1" data-type="float">7.1</span>B</h4>
          <h5>required</h5>
        </div>
      </div>
      <div class="col-md-4">
        <div id="stats-area" style="position: absolute; bottom: 0;">
          <h2><img src="http://placehold.it/60x60" /><span data-final-count="2.4" data-type="float" >0</span><span>M People in need</span></h2>

          <h2><img src="http://placehold.it/60x60" /><span data-final-count="1.2" data-type="float">0</span><span>M People to receive aid</span></h2>
          <h2><img src="http://placehold.it/60x60" /><span data-final-count="77" data-type="int">0</span><span>aid organizations appealing this year</span></h2>
        </div>
      </div>
    </div>
  </div>
  <div id="eyes-looking-area">
  </div>

  <!-- SECOND SLIDE:: FLOATING IMAGES -->
  <div id="slide-1-faced-with-unprecendented-severity" class="window-size slide-element" style="text-align: center">
    <div  class="burst-message">
    <h1>In 2014, we were confronted with <br/>
      <strong>emergencies</strong> of <strong>unprecedented severity</strong>.</h1>
      <h2>The most severe crisise are classified as <strong>Level 3 emergencies</strong></h2>
    </div>
  </div>

  <!-- L3 SLIDES -->
  <div style="position: relative">
    <div id="slide-1-philippines" class="image-slideshow-item" data-played-out="false"
        data-bottom-center="..."  data-top-bottom="..." data-emit-events>

      <div class="first-slide"></div>
      <div class="second-slide"></div>
      <div class="third-slide"></div>

      <!-- Facts -->
      <div class="fact-item" style="bottom: 200px;">
        <span class="fact-number" data-count="123400">0</span>
        <span class="data-icon"><img src="http://placehold.it/50x50" /></span>
        <span>People in need</span>
      </div>
      <div class="fact-item" style="bottom: 100px;">
        <span class="fact-number" data-count="1553400">0</span>
        <span class="data-icon"><img src="http://placehold.it/50x50" /></span>
        <span>Stat Number</span>
      </div>

      <div class="country-title-item"><h1>PHILIPPINES</h1></div>
    </div>

    <div id="slide-2-syria" class="image-slideshow-item" data-played-out="false"
        data-bottom-center="..." data-top-bottom="..." data-emit-events
    >
      <div class="first-slide"></div>
      <div class="second-slide"></div>
      <div class="third-slide"></div>

      <!-- Facts -->
      <div class="fact-item" style="bottom: 200px;">
        <span class="fact-number" data-count="123400">0</span>
        <span class="data-icon"><img src="http://placehold.it/50x50" /></span>
        <span>People in need</span>
      </div>
      <div class="fact-item" style="bottom: 100px;">
        <span class="fact-number" data-count="1553400">0</span>
        <span class="data-icon"><img src="http://placehold.it/50x50" /></span>
        <span>Stat Number</span>
      </div>

      <div class="country-title-item"><h1>SYRIA</h1></div>
    </div>

    <div id="slide-3-south-sudan" class="image-slideshow-item" data-played-out="false"
      data-bottom-center="..." data-top-bottom="..." data-emit-events
    >
      <div class="first-slide"></div>
      <div class="second-slide"></div>
      <div class="third-slide"></div>

      <!-- Facts -->
      <div class="fact-item" style="bottom: 200px;">
        <span class="fact-number" data-count="123400">0</span>
        <span class="data-icon"><img src="http://placehold.it/50x50" /></span>
        <span>People in need</span>
      </div>
      <div class="fact-item" style="bottom: 100px;">
        <span class="fact-number" data-count="1553400">0</span>
        <span class="data-icon"><img src="http://placehold.it/50x50" /></span>
        <span>Stat Number</span>
      </div>

      <div class="country-title-item"><h1>SOUTH SUDAN</h1></div>
    </div>

    <!-- CAR -->
    <div id="slide-4-car" class="image-slideshow-item" data-played-out="false"
      data-bottom-center="..." data-top-bottom="..." data-emit-events
    >
      <div class="first-slide"></div>
      <div class="second-slide"></div>
      <div class="third-slide"></div>

      <!-- Facts -->
      <div class="fact-item" style="bottom: 200px;">
        <span class="fact-number" data-count="123400">0</span>
        <span class="data-icon"><img src="http://placehold.it/50x50" /></span>
        <span>People in need</span>
      </div>
      <div class="fact-item" style="bottom: 100px;">
        <span class="fact-number" data-count="1553400">0</span>
        <span class="data-icon"><img src="http://placehold.it/50x50" /></span>
        <span>Stat Number</span>
      </div>

      <div class="country-title-item"><h1>CENTRAL AFRICAN REPUBLIC</h1></div>
    </div>
      <!--IRAQ -->
      <div id="slide-5-iraq" class="image-slideshow-item" data-played-out="false"
      data-bottom-center="..." data-top-bottom="..." data-emit-events
    >
        <div class="first-slide"></div>
        <div class="second-slide"></div>
        <div class="third-slide"></div>

        <!-- Facts -->
        <div class="fact-item" style="bottom: 200px;">
          <span class="fact-number" data-count="123400">0</span>
          <span class="data-icon"><img src="http://placehold.it/50x50" /></span>
          <span>People in need</span>
        </div>
        <div class="fact-item" style="bottom: 100px;">
          <span class="fact-number" data-count="1553400">0</span>
          <span class="data-icon"><img src="http://placehold.it/50x50" /></span>
          <span>Stat Number</span>
        </div>


        <div class="country-title-item"><h1>IRAQ</h1></div>
      </div>
    </div>



<!-- Latest compiled and minified JavaScript -->
<script src="js/jquery-1.11.1.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>

<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>

<script src="js/skrollr.min.js"></script>
  <script type="text/javascript">

    $(function() {
      /* Styling ..*/
      $("#title-slides-area, #title-slides-area > .row").height($(window).height());

      /* Animation ..  */
      setTimeout ( function () {

        var parent = $("#first-with-people-fades");
        var bar_graph = $("#first-needs-graph");
        var people_layers = 12;
        for (var i = 0; i < people_layers; i ++) {

          var new_div = $("<div />").height(parent.height() * 0.05).addClass("people-fade").css({bottom: (parent.height() * 0.05 * i) + "px" });
          var opacity_new = ((people_layers - i) * (100/people_layers) / 100);
          parent.append( new_div );

          new_div.css("opacity", 0);
          new_div.delay((i+1) * 150).animate({ opacity: opacity_new }, 800);

        }

        bar_graph.css("height", "0%");
        bar_graph.animate({ height: "98%" }, 2000);

        $("#title-slides-area").find("[data-final-count]").each(function () {
            var $this = $(this);
            console.log($this);
            jQuery({ Counter: 0 }).animate({
                      Counter: parseFloat($this.attr("data-final-count")) }, {
                      duration: 2000,
                      easing: 'swing',
                      step: function () {
                        console.log(this.Counter);
                        if ($this.attr("data-type") == "int")
                        { $this.text( Math.ceil(this.Counter) ); }
                        else if ($this.attr("data-type") == "float")
                        { $this.text( Math.ceil(this.Counter * 10) / 10 ); }
                      }
              });

          });

        $("#title-slides-area #stats-area").css("opacity", 0).animate({ "opacity" : 1, bottom : "+=30px" }, 2000);

      },
      500);
    });

  </script>

  <!-- SCRIPTS FOR SECOND SLIDE -->

  <script type="text/javascript">

    $(function() {
      var burstMessage = $(".burst-message");
      burstMessage.css({
        top: "50%", left: "50%"
        , marginTop:  (burstMessage.height()/2 * -1) + "px"
        , marginLeft: (burstMessage.width()/2 * -1)  + "px"
      });
      $("#pre, #post, .window-size").width($(window).width()).height($(window).height());
      function faces_get_images(d) {
        return "<img src='" + d.src + "'/>";
      }

      function slideExplodeItem( targetItem, forwardSpeed, backwardSpeed)
      {
        var midPoint = $(window).height() / 2;
        targetItem.animate(
                            { marginTop: targetItem.position().top > midPoint
                                  ? (midPoint - targetItem.position().top)-midPoint-targetItem.height()-10 + "px"
                                  : targetItem.position().top +  ((midPoint + targetItem.height() - targetItem.position().top ) + midPoint) + "px"}
                                , forwardSpeed,

                                function() { targetItem.animate({marginTop: "0px"}, backwardSpeed, function (){ slideExplodeItem(targetItem, forwardSpeed, backwardSpeed); }) } );
      }
        d3.json("d/faces.json",
          function(error, json) {
            console.log(json);
            var d = d3.select("body #slide-1-faced-with-unprecendented-severity");
            var dm =  d.selectAll("div.image_container")
                .data(json.faces).enter().append("div")
                .html(faces_get_images).classed("image_container", true);


//.style("top", $(window).height() * Math.random() + "px")
//.style("left", $(window).width() * Math.random() + "px")

            dm.each(function(c) {
              $(this).addClass("image-" + c.type);


              $(this).css({ "top" :  $(window).height() * Math.random() + "px", "left": ($(window).width() - $(this).width()) * Math.random() + "px"});

              var midPoint = $(window).height() / 2;
              // console.log($(this).position().top, midPoint, ($(this).position().top - midPoint) - ($(this).position().top - midPoint) - $(this).height());
              // if ($(this).position().top > midPoint) {
              var goForward = 0;
              var goBack = 0;

              switch (c.type) {
                case "big" :
                  goForward = 10000 + (Math.random() * 10000);
                  goBack = 10000 + (Math.random() * 10000);
                  break;
                case "medium" :
                  goForward = 20000 + (Math.random() * 20000);
                  goBack = 20000 + (Math.random() * 20000);
                  break;
                case "small" :
                  goForward = 40000 + (Math.random() * 40000);
                  goBack = 40000 + (Math.random() * 40000);
                  break;
              }
              var targetItem= $(this);
              // setInterval( function() {
                slideExplodeItem(targetItem, goForward, goBack);

              // }, 3000);
            // }
            });


          }
        );
    });
  </script>


<script type="text/javascript">

  $(function () {

    var comma_format = d3.format(",");
    $(".image-slideshow-item, .image-slideshow-item .first-slide, \
          .image-slideshow-item .second-slide, \
          .image-slideshow-item .third-slide")
        .width($(window).width())
        .height($(window).height());


    /* DATA EVENT LISTENERS */
    $(".image-slideshow-item").on("dataBottomCenter", function(e, direction) {

        // console.log( $(this).offset().top, $(window).scrollTop(), $(this).offset().top - $(window).scrollTop() );
        // console.log("THIS", $(this), e, direction);
        var played = $(this).attr("data-played-out") == "true";

        if (!played) {
          var $target = $(this);

          console.log($(this));
          play_animation ($target);

          $(this).attr("data-played-out", "true");
        }

    });

    function play_animation($target) {
        $target.find(".country-title-item");
        $target.find(".first-slide").delay(500).fadeOut(500, function() {

            $(this).closest(".image-slideshow-item").find(".country-title-item").animate({opacity: 1, marginBottom: "+=10px"}, 2000);

            $(this).closest(".image-slideshow-item")
              .find(".fact-number").each(function() {

              var $this = $(this);
              console.log($this);

              $this.closest(".fact-item").delay(200).animate({opacity: 1, bottom: "+=20px" }, 3000, "swing");
              jQuery({ Counter: 0 }).animate({ Counter: parseInt($this.attr("data-count")) }, {
                duration: 2000,
                easing: 'swing',
                step: function () {
                  $this.text(comma_format( Math.ceil(this.Counter) ));
                }
              });
            });

            $target.find(".second-slide").delay(800).fadeOut(500, function() {});

        });
    };



    var s = skrollr.init({
    keyframe: function(element,name, direction) {
        $(element).trigger(name, direction);
    }
    ,
    edgeStrategy: 'set',
      easing: {
        WTF: Math.random
      }
    });
  });


  </script>
</body>
</html>
